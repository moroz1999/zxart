<div class="comment">
  <div class="comment-header">
    <app-comment-author [author]="comment.author"></app-comment-author>
    <span class="comment-date">{{ comment.date }}</span>
    
    <div class="comment-actions">
      <button pButton type="button" (click)="onReply()" [label]="'comments.reply' | translate" class="p-button-link"></button>
      <button *ngIf="comment.canEdit" pButton type="button" (click)="onEdit()" [label]="'comments.edit' | translate" class="p-button-link"></button>
      <button *ngIf="comment.canDelete" pButton type="button" (click)="onDelete()" [label]="'comments.delete' | translate" class="p-button-link"></button>
    </div>
  </div>
  
  <div *ngIf="!showEditForm" class="comment-content" [innerHTML]="comment.content"></div>
  
  <app-comment-form *ngIf="showEditForm" [targetId]="comment.parentId || 0" [commentToEdit]="comment" (commentSaved)="onCommentSaved($event)" (cancelled)="showEditForm = false"></app-comment-form>
  <app-comment-form *ngIf="showReplyForm" [targetId]="comment.id" (commentSaved)="onCommentSaved($event)" (cancelled)="showReplyForm = false"></app-comment-form>

  <div class="comment-children" *ngIf="comment.children && comment.children.length > 0">
    <app-comment *ngFor="let child of comment.children" [comment]="child" (commentChanged)="onCommentSaved(child)"></app-comment>
  </div>
</div>
