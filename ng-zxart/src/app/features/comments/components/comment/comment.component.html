<div class="comment">
  <div class="comment-header">
    <app-comment-author [author]="comment.author"></app-comment-author>
    <span class="comment-date">{{ comment.date }}</span>

    <div class="comment-actions">
      <button mat-button type="button" (click)="onReply()">{{ 'comments.reply' | translate }}</button>
      <button *ngIf="comment.canEdit" mat-button type="button" (click)="onEdit()">{{ 'comments.edit' | translate }}</button>
      <button *ngIf="comment.canDelete" mat-button type="button" (click)="onDelete()">{{ 'comments.delete' | translate }}</button>
    </div>
  </div>

  <div *ngIf="!showEditForm" class="comment-content" [innerHTML]="comment.content"></div>

  <app-comment-form *ngIf="showEditForm" [targetId]="comment.parentId || 0" [commentToEdit]="comment" (commentSaved)="onCommentSaved($event)" (cancelled)="showEditForm = false"></app-comment-form>
  <app-comment-form *ngIf="showReplyForm" [targetId]="comment.id" (commentSaved)="onCommentSaved($event)" (cancelled)="showReplyForm = false"></app-comment-form>

  <div class="comment-children" *ngIf="comment.children && comment.children.length > 0">
    <app-comment *ngFor="let child of comment.children" [comment]="child" (commentChanged)="onCommentSaved(child)"></app-comment>
  </div>
</div>
